<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brain Food – HEAD FACE</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-blue-100 to-blue-300 min-h-screen">

<!-- Header -->
<header class="bg-white shadow-md py-3 px-6 flex justify-between items-center">
  <h1 class="text-xl font-bold text-blue-700">Brain Food</h1>
  <a href="home.html"
     class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded-xl font-semibold">
     กลับหน้า หลัก
  </a>
</header>

<!-- Dashboard -->
<section class="max-w-3xl mx-auto mt-6 grid grid-cols-2 gap-4">
  <div class="bg-white/80 rounded-xl p-4 text-center shadow">
    <p class="text-gray-500">บทที่เรียน</p>
    <p id="stat-lesson" class="text-2xl font-bold text-blue-700">0</p>
  </div>
  <div class="bg-white/80 rounded-xl p-4 text-center shadow">
    <p class="text-gray-500">Quiz ที่ทำ</p>
    <p id="stat-quiz" class="text-2xl font-bold text-blue-700">0</p>
  </div>
</section>

<!-- Menu boxes -->
<section class="max-w-4xl mx-auto mt-10 grid md:grid-cols-3 gap-6 px-4">

  <!-- Snack -->
  <div id="box-snack" class="group relative cursor-pointer">
    <div
      class="bg-gradient-to-r from-green-400 to-lime-500 rounded-2xl h-40 flex items-center justify-center shadow-lg
             group-hover:scale-105 transition">
      <span class="text-white text-xl font-bold">Snack Set</span>
    </div>
    <p class="mt-2 text-center text-sm text-gray-700">
      สรุปสั้น กระชับ + Quiz 5 ข้อ
    </p>
  </div>

  <!-- Full -->
  <div id="box-full" class="group relative cursor-pointer">
    <div
      class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl h-40 flex items-center justify-center shadow-lg
             group-hover:scale-105 transition">
      <span class="text-white text-xl font-bold">Full Meal</span>
    </div>
    <p class="mt-2 text-center text-sm text-gray-700">
      บทเรียนเต็ม + Quiz 15 ข้อ (เฉพาะ MAX)
    </p>

    <!-- Overlay lock -->
    <div id="lock-full"
         class="absolute inset-0 rounded-2xl bg-white/80 backdrop-blur flex flex-col items-center justify-center text-center text-purple-600 font-semibold hidden">
      <p>เฉพาะ MAX</p>
    </div>
  </div>

  <!-- Salad -->
  <div id="box-salad" class="group relative cursor-pointer">
    <div
      class="bg-gradient-to-r from-teal-400 to-cyan-500 rounded-2xl h-40 flex items-center justify-center shadow-lg
             group-hover:scale-105 transition">
      <span class="text-white text-xl font-bold">Salad Set</span>
    </div>
    <p class="mt-2 text-center text-sm text-gray-700">
      Quiz รวม ทุกบท (20 ข้อ)
    </p>

    <div id="lock-salad"
         class="absolute inset-0 rounded-2xl bg-white/80 backdrop-blur flex flex-col items-center justify-center text-center text-cyan-700 font-semibold hidden">
      <p>เฉพาะ MAX</p>
    </div>
  </div>

</section>

<!-- Modal placeholder / ภายหลังจะใช้เลือกวิชา etc. -->
<div id="modal-root"></div>

<script>
  /* ─────────   user & MAX check   ───────── */
  const user   = JSON.parse(localStorage.getItem("user") || "null");
  const isMAX  = !!user?.lineId;     // มี lineId = สมัคร MAX

  // ล็อกกล่องเฉพาะ MAX
  if (!isMAX) {
    document.getElementById("lock-full").classList.remove("hidden");
    document.getElementById("lock-salad").classList.remove("hidden");
  }

  /* ─────────   dashboard stats   ───────── */
  async function loadStats() {
    if (!user) return;
    const res  = await fetch(
      `https://script.google.com/macros/s/AKfycbxQyMf_zMNuZoa_JLqa2S5LJYgxd1HwDfnMw-3_FtMH-mN2Db72O4xfqpU17zg2mebPkw/exec?action=get_brain_stats&no=${user.no}`
    );
    const data = await res.json();
    if (data.status === "success") {
      const [lesson, quiz] = data.count.split(" ");
      document.getElementById("stat-lesson").textContent = lesson;
      document.getElementById("stat-quiz").textContent   = quiz;
    }
  }
  loadStats();

  /* ─────────   click-handlers (เฉพาะ Step 1)   ───────── */
  document.getElementById("box-snack").onclick = () =>
    alert("Snack Set – ขั้นถัดไปจะให้เลือกวิชา ✨");

  document.getElementById("box-full").onclick = () => {
    if (isMAX) alert("Full Meal – เฉพาะ MAX (จะเลือกวิชาได้ใน Step ต่อไป)");
  };

  document.getElementById("box-salad").onclick = () => {
    if (isMAX) alert("Salad Set – จะเลือกวิชาได้ใน Step ต่อไป");
    else       alert("ฟีเจอร์นี้สำหรับ MAX เท่านั้น");
  };
</script>
</body>
</html>
